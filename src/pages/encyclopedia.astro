---
import AppShell from "@/layouts/AppShell.astro";
import { getCollection } from "astro:content";

const all = await getCollection("universe");
const type = Astro.url.searchParams.get("type");
const entries = all
  .filter(e => type ? e.data.type === type : true)
  .sort((a,b) => (a.data.order ?? 999) - (b.data.order ?? 999));
---
<AppShell title="Encyclopedia" sidebar={true}>
  <h1 class="text-2xl font-semibold mb-4">Encyclopedia {type ? `— ${type}` : ""}</h1>
  <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
    {entries.map(({ slug, data }) => (
      <a href={`/encyclopedia/${slug}`} class="block rounded-xl border border-white/10 p-4 hover:bg-white/5">
        <div class="text-sm opacity-70 uppercase">{data.type}</div>
        <div class="font-semibold">{data.title}</div>
        <div class="text-sm opacity-80 mt-1">{data.summary}</div>
        {data.tags?.length ? <div class="mt-2 text-xs opacity-70">{data.tags.join(" · ")}</div> : null}
      </a>
    ))}
  </div>
</AppShell>


